---
title: "Exploring Depression and Anxiety: Objective Hardship Exposure and Psychological Distress Among Pregnant Individuals"
subtitle: "Analysis of Prenatal Mental Health During the Covid-19 Pandemic"
author: 
  - Boxuan Yi
format: 
  pdf:
    documentclass: article
    geometry: margin = 1in
    abstract: "The outbreak of the Covid-19 pandemic was a substantial stressor, especially for pregnant individuals. This paper uses Bayesian model and logistic regression to estimate levels of prenatal depression and anxiety during this hardship. The analysis reveals that the perceived threats to oneself and the unborn child are positively correlated to the mental distress, especially among younger pregnant individuals with lower levels of education and from lower-income families."
date: "27 March 2024"
date-format: "D MMMM YYYY"
number-sections: true
thanks: "Code and data in this analysis is available at: https://github.com/Elaineyi1/Prenatal_Mental_Health"
bibliography: references.bib
toc: true
---
\newpage
# Introduction {#sec-introduction}
```{r}
#| include: false
library(arrow)
library(readr)
library(here)
library(ggplot2)
library(janitor)
library(rstanarm)
library(dplyr)
library(modelsummary)
library(broom)
library(knitr)
```

```{r}
#| include: false
# clean_data <- read_parquet(file = "inputs/data/cleaned_mental_health.parquet")
clean_data <- read_csv(
    file = here("inputs/data/cleaned_mental_health.csv"),
    show_col_types = FALSE)
```

# Data {#sec-data}
## Data Source and Measurement
The prenatal mental health dataset from the Open Science Framework was designed to explore the relationship between exposure to objective hardship caused by the Covid -19 pandemic and psychological distress in pregnant individuals [@osfPregnancyDuring]. The  study population is pregnant individuals aged 17 or older, with gestation periods of no more than 35 weeks, residing in Canada. Data were collected from May 2020 to December 2021, containing demographic information, mental health data and basic birth outcomes [@nihPrenatalMental]. For this paper, I will only use data collected from May 2020 to December 2020 to analyze the prenatal mental health during the onset of the outbreak, a period highly marked by panic and hardship. 

Participants were recruited through advertisements via pregnancy organizations, care providers, social media, and paid ads on Facebook and Instagram, with the chance to win a $500 gift card. A portion of advertisements targeted geographic regions and sociodemographic groups with less representation to reduce underrepresentation [@nihPrenatalMental]. 

Prenatal data, including age, 2019 household income in Canadian dollars, and education level, were collected as part of the national Pregnancy during the COVID-19 Pandemic (PdP) project using online questionnaires through REDCap. Birth data were also acquired using parents reports in REDCap [@nihPrenatalMental]. Depression symptoms were self-assessed using the Edinburgh Postnatal Depression Scale (EPDS), consisting of 10 questions, each scored from 0 to 3, with possible scores ranging from 0 to 30. Anxiety symptoms were self-assessed by Patient-Reported Outcomes Measurement Information System (PROMIS), including 7 questions, each scored from 1 to 5, with possible total scores ranging from 7 to 35. Higher scores on both surveys indicate more severe depression or anxiety symptoms. The surveys were available in either English or French.

Data are available for 10,772 participants. After excluding observations with missing values and setting the delivery month from May 2020 to December 2020, 3266 observations remain. Further details regarding data cleaning can be found in @sec-appendix. All participants in this study provided informed consent. 

```{r}
#| include: false
age_levels <- c("Under 27", "27 to 34", "35 to 39", "40 and above")
income_levels <- c("Less than $20,000", "$20,000 - $39,999", "$40,000 - $69,999", 
                   "$70,000 - $99,999", "$100,000 - $124,999", "$125,000 - $149,999",
                   "$150,000 - $174,999", "$175,000 - $199,999", "$200,000+")
education_levels <- c("Less than high school diploma", "High school diploma", "College/trade school", 
                      "Undergraduate degree", "Masters degree", "Doctoral Degree")
month_levels <- c("Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
clean_data$age_group <- factor(clean_data$age_group, levels = age_levels)
clean_data$household_income <- factor(clean_data$household_income, levels = income_levels)
clean_data$maternal_education <- factor(clean_data$maternal_education, levels = education_levels)
clean_data$month <- factor(clean_data$month, levels = month_levels)
```

```{r}
#| label: fig-month
#| fig-cap: Distribution of Levels of Depression and Anxiety by Month
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2
#| fig-subcap: ["Distribution of Edinburgh Postnatal Depression Scale Scores by Month", "Distribution of Promis Anxiety Scores by Months"]
clean_data |>
  ggplot(aes(x = month, y = EPDS)) +
  geom_boxplot() + ylim(0,1)

clean_data |>
  ggplot(aes(x = month, y = PROMIS)) +
  geom_boxplot() + ylim(0,1)
```

```{r}
#| message: false
#| echo: false
#| warning: false
#| label: fig-income_age
#| fig-cap: The Distribution of Age Groups and Household Income for Pregnant Participants
# Pastel1
clean_data |>
  ggplot(mapping = aes(x = household_income, fill = age_group)) +
  geom_bar(position = "dodge2") + 
  theme(legend.position = "bottom") +
  scale_fill_brewer(palette = "Set2") +
  theme(axis.text.x = element_text(angle = 50, hjust = 1)) +
  labs(x = "Household Income in 2019", y = "Number of Observations", fill = "Age Group") 
```


```{r}
#| message: false
#| echo: false
#| warning: false
#| label: fig-education_age
#| fig-cap: The Distribution of Age Groups and Level of Education for Pregnant Participants
clean_data |>
  ggplot(mapping = aes(x = maternal_education, fill = age_group)) +
  geom_bar(position = "dodge2") + 
  theme(legend.position = "bottom") +
  scale_fill_brewer(palette = "Set2") +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  labs(x = "Individual's Education Level", y = "Number of Observations", fill = "Age Group")
```

```{r}
#| message: false
#| echo: false
#| warning: false
#| label: tbl-age_language
#| tbl-cap: Levels of Depression and Anxiety Among Different Age Groups
clean_data |> group_by(age_group, language) |> 
  summarise(average_depression = mean(EPDS), average_anxiety = mean(PROMIS)) |> 
  rename("Age Group" = age_group, 
         "Survey Language" = language,
         "Average Level of Depression" = average_depression, 
         "Average Level of Anxiety" = average_anxiety) |>
  kable()
```

```{r}
#| label: fig-average_depression_and_anxiety
#| fig-cap: Distribution of Levels of Depression and Anxiety by Education and Household Income
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2
#| fig-subcap: ["Distribution of Levels of Depression by Education", "Distribution of Levels of Depression by Household Income", "Distribution of Levels of Anxiety by Education", "Distribution of Levels of Anxiety by Household Income"]
clean_data %>%
  group_by(maternal_education) %>%
  summarise(average_depression = mean(EPDS)) %>%
  ggplot(aes(x = maternal_education, y = average_depression)) +
  geom_bar(stat = "identity", fill = "cornflowerblue") + geom_text(aes(label = round(average_depression, 3)), vjust = -0.5) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) + ylim(0, 0.6) +
  labs(x="Education", y="Average Level of Depression")

clean_data %>%
  group_by(household_income) %>%
  summarise(average_depression = mean(EPDS)) %>%
  ggplot(aes(x = household_income, y = average_depression)) + 
  geom_text(aes(label = round(average_depression, 3)), vjust = -0.5) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) + ylim(0, 0.6)+
  geom_bar(stat = "identity", fill = "cornflowerblue") + labs(x="Household Income in 2019", y="Average Level of Depression")

clean_data %>%
  group_by(maternal_education) %>%
  summarise(average_anxiety = mean(PROMIS)) %>%
  ggplot(aes(x = maternal_education, y = average_anxiety)) +
  geom_bar(stat = "identity", fill = "salmon2") + geom_text(aes(label = round(average_anxiety, 3)), vjust = -0.5) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) + ylim(0, 0.6)+
  labs(x="Education", y="Average Level of Anxiety")

clean_data %>%
  group_by(household_income) %>%
  summarise(average_anxiety = mean(PROMIS)) %>%
  ggplot(aes(x = household_income, y = average_anxiety)) + 
  geom_bar(stat = "identity", fill = "salmon2") +
  geom_text(aes(label = round(average_anxiety, 3)), vjust = -0.5) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) + ylim(0, 0.6) +
  labs(x="Household Income in 2019", y="Average Level of Anxiety")
```

```{r}
#| label: fig-danger
#| fig-cap: Relationship between Perceived Level of Danger and Prenatal Mental Health
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2
#| fig-subcap: ["Perceived Danger to Self and Depression", "Perceived Danger to the Unborn and Depression", "Perceived Danger to Self and Anxiety", "Perceived Danger to the Unborn and Anxiety"]
clean_data |>
  ggplot(aes(x = threaten_life, y = EPDS, color = language)) +
  geom_smooth(method = "lm") + 
  geom_hline(yintercept = 0.3, linetype = "dashed", color = "black") +
  theme_classic() + 
  geom_text(aes(x = 1, y = 0.3, label = "0.3"), color = "black", vjust = -0.5, hjust = 1) +
  labs(x="Perceived Level of Danger", y = "Level of Prenatal Depression")+ ylim(0,1)

clean_data |>
  ggplot(aes(x = threaten_baby_danger, y = EPDS, color = language)) +
  geom_smooth(method = "lm") + 
  geom_hline(yintercept = 0.3, linetype = "dashed", color = "black") +
  theme_classic() + 
  geom_text(aes(x = 1, y = 0.3, label = "0.3"), color = "black", vjust = -0.5, hjust = 1) +
  labs(x="Perceived Danger to Unborn Baby's Life", y = "Level of Prenatal Depression") + ylim(0,1)

clean_data |>
  ggplot(aes(x = threaten_life, y = PROMIS, color = language)) +
  geom_smooth(method = "lm") +
  theme_classic() + geom_hline(yintercept = 0.4, linetype = "dashed", color = "black")+
  geom_text(aes(x = 1, y = 0.4, label = "0.4"), color = "black", vjust = -0.5, hjust = 1) +
  labs(x="Perceived Level of Danger", y = "Level of Prenatal Anxiety")+ ylim(0,1)

clean_data |>
  ggplot(aes(x = threaten_baby_danger, y = PROMIS, color = language)) +
  geom_smooth(method = "lm") + 
  geom_hline(yintercept = 0.4, linetype = "dashed", color = "black") +
  theme_classic() + 
  geom_text(aes(x = 1, y = 0.4, label = "0.4"), color = "black", vjust = -0.5, hjust = 1) +
  labs(x="Perceived Danger to Unborn Baby's Life", y = "Level of Prenatal Anxiety") + ylim(0,1) 
```

# Model {#sec-model}
```{r}
#| include: false
depression_model <- readRDS(file = here::here("model/depression.rds"))
```

```{r}
#| include: false
anxiety_model <- readRDS(file = here::here("model/anxiety.rds"))
```

# Results {#sec-results}
```{r}
#| message: false
#| echo: false
#| warning: false
#| label: tbl-depression_model
#| tbl-cap: Estimating Prenatal Depression given Age, Household Income, Education Level and Choice of Language
modelsummary(
  list(
    "Depression" = depression_model))
```
```{r}
#| message: false
#| echo: false
#| warning: false
#| label: fig-depression_interval
#| fig-cap: The Coefficients and Confidence Interval in the Depression Model
modelplot(depression_model, conf_level = 0.95, color = 'royalblue3') +
  labs(x = "Depression and 95% Confidence Interval")
```

```{r}
#| message: false
#| echo: false
#| warning: false
#| label: tbl-anxiety_model
#| tbl-cap: Estimating Prenatal Anxiety given Age Group, Household Income, Education Level and Choice of Language.
modelsummary(
  list(
    "Anxiety" = anxiety_model))
```


```{r}
#| message: false
#| echo: false
#| warning: false
#| label: fig-anxiety_interval
#| fig-cap: The Coefficients and Confidence Interval in the Anxiety Model
modelplot(anxiety_model, conf_level = 0.95, color = 'indianred3') +
  labs(x = "Anxiety and 95% Confidence Interval")
```

# Discussions {#sec-discussions}
```{r}
#| label: fig-weight_length_delivery
#| fig-cap: Distribution of Birth Weight and Length and Prenatal Mental Health by Delivery Mode
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2
#| fig-subcap: ["Birth Weight and Depression by Delivery Mode", "Birth Weight and Anxiety by Delivery Mode", "Birth Length and Depression by Delivery Mode", "Birth Length and Anxiety by Delivery Mode"]
clean_data |>
  ggplot(aes(x = EPDS, y = birth_weight, color = delivery_mode)) +
  geom_smooth(method = "lm")+
  theme_minimal() + labs(x = "The Level of Prenatal Depression", y = "Birth Weight (grams)")

clean_data |>
  ggplot(aes(x = PROMIS, y = birth_weight, color = delivery_mode)) +
  geom_smooth(method = "lm")+
  theme_minimal() +
  labs(x = "The Level of Prenatal Anxiety", y = "Birth Weight (grams)")

clean_data |>
  ggplot(aes(x = EPDS, y = birth_length, color = delivery_mode)) +
  geom_smooth(method = "lm")+
  theme_minimal() + labs(x = "The Level of Prenatal Depression", y = "Birth Length (centimeters)")

clean_data |>
  ggplot(aes(x = PROMIS, y = birth_length, color = delivery_mode)) +
  geom_smooth(method = "lm")+
  theme_minimal() +
  labs(x = "The Level of Prenatal Anxiety", y = "Birth Length (centimeters)")
```
\newpage
# Appendix {#sec-appendix}
```{r}
#| message: false
#| echo: false
#| warning: false
#| label: fig-language_income_education
#| fig-cap: Income and Education Groups Distribution Based on the Choice of Survey Language
#| layout-ncol: 2
#| fig-subcap: ["Distribution of Income by Language", "Distribution of Education by Language"]
clean_data |>
  ggplot(aes(x = household_income, fill = language)) +
  stat_count(position = "dodge") +
  theme_minimal() +
  coord_flip() +
  scale_fill_brewer(palette = "Set1") + theme(legend.position = "bottom")

clean_data |>
  ggplot(aes(x = maternal_education, fill = language)) +
  stat_count(position = "dodge") +
  theme_minimal() +
  coord_flip() +
  scale_fill_brewer(palette = "Set1") + theme(legend.position = "bottom")
```

```{r}
#| message: false
#| echo: false
#| warning: false
#| label: fig-danger_baby
#| fig-cap: Distribution of the Preceived Danger to Baby and Preceived Potential Harm to Baby
clean_data |>
  ggplot(aes(x = threaten_baby_danger, y = threaten_baby_harm)) +
  geom_jitter(color='darkgray', alpha=0.4) +
  geom_smooth() + theme_minimal()
```
\newpage
# References